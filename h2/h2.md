 # x) Lue ja vastaa lyhyesti kysymyksiin. Tässä alakohdassa x ei tällä kertaa tarvitse lukea artikkeleita kokonaan, ei tarvitse tiivistää niitä, eikä tehdä testejä koneella.
   Selitä tuskan pyramidin idea 1-2 virkkeellä. Bianco 2013: Pyramid of Pain. (Katso eritoten pyramidin kuvaa.)
  Selitä timanttimallin (Diamond Model) idea 1-2 virkkeellä. Tekijä esittelee sen aika juhlallisesti, voit myös etsiä yksinkertaisempia artikkeleita hakukoneella tai kelata suoraan timantin kuvaan. Caltagirone et al 2013: Diamond Model

Tuskan pyramidi 

- Tuskan pyramidi kuvaa mallia kyberhyökkääjään taktiikkojen ja strategioiden lamauttaumisesta
- Mitä korkeammalla pyramidia se on niin sitä epäkätevämpää se on hyökkääjälle esim. ip-osoitteen estäminen vähän epäkätevää, hyökkääjään työkalun estäminen/lamauttaminen erittäin epäkätevää[lähde 3](Bianco 2013 luettu 29.10.2025 luettavissa: https://detect-respond.blogspot.com/2013/03/the-pyramid-of-pain.html)
 

Timanttimalli

Löysin googlehaulla vähän helposti sulatettavissa olevan selityksen https://kravensecurity.com/diamond-model-analysis/

- Mallissa timantti muodostuu vastustajan(adversary) ja uhrin (victim) välillä, ne linkittyvät infrastructure (mitä kautta hyökkäys levisi) ja capability (mitä keinoja hyökkääjä käytti) kautta
- Timanttimalli on yksi lukuisista malleista, jolla voidaan analysoida oppia kyberhyökkäysten kulkua



 # a) Apache log. Asenna Apache-weppipalvelin paikalliselle virtuaalikoneellesi. Surffaa palvelimellesi salaamattomalla HTTP-yhteydellä, http://localhost . Etsi omaa sivulataustasi vastaava lokirivi. Analysoi yksi tällainen lokirivi, eli selitä sen kaikki kohdat. (Jos Apache ei ole kovin tuttu, voit tätä tehtävää varten vain asentaa sen ja testata oletusweppisivulla. Eli ei tarvitse tehdä omia kotisvuja tms.)

 Minulla on vahva epäilys, että Kali Linuxissa on valmiiksi asennettu Apache2, joten tarkistin sen komennolla 

    sudo systemctl status apache2


  [image](apacheck.PNG)


  Sehän oli, mutta se ei ollut päällä joten käynnistin sen 

    sudo systemctl start apache2


   Olen käyttänyt Apache2 aikaisemmin Linux-palvelimet kurssilla, joten päätin kertauksen vuoksi tehdä oman nettisivun

 Hakemiston luonti 

      sudo mkdir -p /var/www/minunsivu/public_html

Sivun luonti 

    sudo micro /var/www/minunsivu/public_html/index.html


   HTML teksti

   [image](index.PNG)


   Tässä vaiheessa jouduin katsomaan apua netistä, löysin napakan tutoriaalin siitä https://www.veeble.com/kb/how-to-setup-apache-to-host-a-website-in-linux/

   Minun pitää lisätä tarvittavat asiat conf tiedostoon

    micro  /etc/apache2/sites-available/minunsivu.com.conf

   Ja  muokaten minunsivu.com kohtiin

  [image](conf.PNG)


Se pitää vielä  pistää päälle komennolla 



    sudo a2ensite minunsivu.com.conf



Sitten menin minunsivu.com ja..

  [image](apachework.PNG)


 Se on pystyssä


 Tämä oli itselleni hyvää kertausta, koska siitä on melkein vuosi kun olin viimeksi käyttänyt Apache2:sta 

 Nyt sitten itse asiaan: Tehtävän vinkeissä oli komento 

    sudo tail -F /var/log/apache2/access.log

 Joten vaihdoin sen omalleni nettisivulleni

 
    sudo tail -F /var/log/minunsivu.com/access.log



  Suljin  omat apachesivut 

  Testasin ensiksi curlilla, koska halusin nähdä miltä se näyttää lokeissa ja menin tietenkin myös ihan selaimen kautta sivuille 

[image](log1.PNG)

127.0.0.1: Nettisivulle menijän IP-osoite (tässä tapauksessa tietenkin minä eli localhost)

Seuraavaksi on päivämäärä, kellonaika, aikavyöhyke aika yksiselitteistä

"GET / HTTP/ 1.1": GET-tyyppinen  HTTP pyyntö eli nimensä mukaan pyytää tietoa, HTTP protokolla versio 1.1

200: HTTP:n statuskoodi, tarkoittaa, että kaikki meni hyvin

404/467: pyynnön koko tavuina (selain vs curl yllättävän vähän koko eroa)

"-": Referointi kenttä, näyttää jos käyttäjä on tullut jostain toisesta paikasta/nettisivulta tälle sivulle [lähde](https://stackoverflow.com/questions/9234699/understanding-apaches-access-log)

"Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0"/ "curl/8.13": näyttää miten käyttäjä on päässyt sivulle, tässä firefox ja curl (uusin curl versio on 8.16 kali näköjään käyttää vanhempaa versiota)
  

  

 
 # b) Nmapped. Porttiskannaa oma weppipalvelimesi käyttäen localhost-osoitetta ja 'nmap -A' päällä. Selitä tulokset. (Pelkkä http-portti 80/tcp riittää)
 
 # c) Skriptit. Mitkä skriptit olivat automaattisesti päällä, kun käytit "-A" parametria? (Näkyy avoimien porttinumeroiden alta, http-blah, http-blöh...).
 
 # d) Jäljet lokissa. Etsi weppipalvelimen lokeista jäljet porttiskannauksesta (NSE eli Nmap Scripting Engine -skripteistä skannauksessa). Löydätkö sanan "nmap" isolla tai pienellä? Selitä osumat. Millaisilla hauilla tai säännöillä voisit tunnistaa porttiskannauksen jostain muusta lokista, jos se on niin laaja, että et pysty lukemaan itse kaikkia rivejä?
 
 # e) Wire sharking. Sieppaa verkkoliikenne porttiskannatessa Wiresharkilla. Huomaa, että localhost käyttää "Loopback adapter" eli "lo". Tallenna pcap. Etsi kohdat, joilla on sana "nmap" ja kommentoi niitä. Jokaisen paketin jokaista kohtaa ei tarvitse analysoida, yleisempi tarkastelu riittää.
 
 # f) Net grep. Sieppaa verkkoliikenne 'ngrep' komennolla ja näytä kohdat, joissa on sana "nmap".
 
 # g) Agentti. Vaihda nmap:n user-agent niin, että se näyttää tavalliselta weppiselaimelta.
 
 # h) Pienemmät jäljet. Porttiskannaa weppipalvelimesi uudelleen localhost-osoitteella. Tarkastele sekä Apachen lokia että siepattua verkkoliikennettä. Mikä on muuttunut, kun vaihdoit user-agent:n? Löytyykö lokista edelleen tekstijono "nmap"?
 
 # i) Hieman vaikeampi: LoWeR ChEcK. Poista skritiskannauksesta viimeinenkin "nmap" -teksti. Etsi löytämääsi tekstiä /usr/share/nmap -hakemistosta ja korvaa se toisella. Tee porttiskannaus ja tarkista, että "nmap" ei näy isolla eikä pienellä kirjoitettuna Apachen lokissa eikä siepatussa verkkoliikenteessä. (Tässä tehtävässä voit muokata suoraan lua-skriptejä /usr/share/nmap alta, 'sudoedit'. Muokatun version paketoiminen siis rajataan ulos tehtävästä.)
 
 # j) Vapaaehtoinen, vaikea: Invisible, invincible. Etsi jokin toinen nmap:n skripti, jonka verkkoliikenteessä esiintyy merkkijono "nmap" isolla tai pienellä. Muuta nmap:n koodia niin, että tuo merkkijono ei enää näy verkkoliikenteessä.


 ## Lähteet
1. https://terokarvinen.com
 
2. https://terokarvinen.com/verkkoon-tunkeutuminen-ja-tiedustelu/#h2-lempivari-violetti

3. Bianco 2013 luettu 29.10.2025 luettavissa: https://detect-respond.blogspot.com/2013/03/the-pyramid-of-pain.html

4. https://kravensecurity.com/diamond-model-analysis/

5. https://www.veeble.com/kb/how-to-setup-apache-to-host-a-website-in-linux/

6. https://stackoverflow.com/questions/9234699/understanding-apaches-access-log

 
